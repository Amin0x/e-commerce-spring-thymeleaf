<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Navbar Fragment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../static/public/css/bootstrap-5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../../../static/public/css/style.css">
    <style>
        
    </style>
</head>

<body dir="rtl">
    <nav th:fragment="navbar" class="navbar-wrp">
        <div class="notification-bar" id="notification" th:if="${notification} != null">
            <p th:text="${notification}">Lorem ipsum, dolor sit amet consectetur adipisicing elit. Possimus, natus. Nesciunt tempore nobis id hic. Nobis quaerat qui quibusdam repellendus!</p>
        </div>
        <div class="w-100" id="navbar">
            <div class="nav-content">
                <div class="logo flex-grow-0">
                    <div>
                        <a href="/">
                            <img width="32" height="32" th:src="@{/public/imgs/logo2.png}" src="../../static/public/imgs/logo2.png" alt="Logo">
                        </a>
                    </div>
                </div>
                <div class="nav-menu">
                    <ul class="menu-container">
                        <li class="menu-item"><a class="menu-link" href="/">الرئيسية</a></li>
                        <li class="menu-item"><a class="menu-link" href="/products">المنتجات</a></li>
                        <li class="menu-item"><a class="menu-link" href="/offers">العروض</a></li>
                        <li class="menu-item"><a class="menu-link" href="/products/bestselling">الاكثر مبيعا</a></li>
                        <li class="menu-item">
                            <a class="menu-link dropdown" href="#" id="dropdownButton">الاقسام</a>
                            <ul class="menu-container submenu" id="categoryMenu">
                                <li class="menu-item"><a class="menu-link" href="#">Lorem, ipsum.</a></li>
                                <li class="menu-item"><a class="menu-link" href="#">Lorem, ipsum dolor.</a></li>
                                <li class="menu-item"><a class="menu-link" href="#">Lorem, ipsum dolor.</a></li>
                                <li class="menu-item"><a class="menu-link" href="#">Lorem, ipsum dolor.</a></li>
                                <li class="menu-item"><a class="menu-link" href="#">Lorem, ipsum dolor.</a></li>
                            </ul>
                        </li>                        
                    </ul>
                </div>
                <div class="nav-search"></div>
                
                <div class="cart">
                    <a href="/cart" id="dropdownCartButton">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8 text-gray-600">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" />
                        </svg>
                        <span class="cart__badge" id="cartItemsCount">0</span>
                    </a>
                    <div th:if="false" class="cart__dropdown" id="dropdownCart">
                        <div class="cart__dropdown-content" id="dropdownCartContent">
                            <div class="cart__dropdown-item">
                                <img class="cart__dropdown-item-img" width="50" height="50" th:src="@{/public/imgs/product1.jpg}" src="/static/public/imgs/product1.jpg" alt="Product">
                                <div class="cart__dropdown-item-info">
                                    <h4 class="cart__dropdown-item-title">Product Title</h4>
                                    <p class="cart__dropdown-item-price">$99.99</p>
                                    <span class="cart__dropdown-item-quantity">Quantity: 1</span>
                                    <button class="btn btn-sm btn-danger cart__dropdown-item-remove">Remove</button>
                                </div>
                            </div>
                        </div>
                        <div class="cart__dropdown-total">
                            <h4>Total:</h4>
                            <p>$99.99</p>
                            <a href="#" class="btn btn-primary w-100">Checkout</a>
                            <div class="cart__dropdown-actions">
                                <button class="btn btn-sm btn-primary cart__dropdown-update">Update Cart</button>
                                <button class="btn btn-sm btn-danger cart__dropdown-clear">Clear Cart</button>
                            </div>
                        </div>
    
                    </div>
                </div>
                <div class="profile">                    
                    <a class="button dropdown" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img th:src="@{/public/imgs/user-avatar.png}" src="../../../static/public/imgs/user-avatar.png" alt="User Avatar">
                    </a>                   
                    <div class="profile-menu profile-menu-right" id="dropdownMenu">
                        <a class="dropdown-item" href="#">Profile</a>
                        <a class="dropdown-item" href="#">Logout</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Help</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">About Us</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Contact Us</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Terms & Conditions</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Privacy Policy</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">FAQ</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Return Policy</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Shipping & Delivery</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Payment Options</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Returns & Exchanges</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="serarch-bar"></div>
        <script>
            document.addEventListener('DOMContentLoaded', async function(){
                const res = await fetch('/carts/getCart', {
                    method: 'GET',
                });

                if(res != undefined && res.status == 200){
                    const data = await res.json();
                    document.getElementById("cartItemsCount").textContent = data.totalItems;
                }
            });
            document.getElementById("dropdownCartButton").addEventListener("click", function() {
                document.getElementById("dropdownCart").classList.toggle("active");
            });

            document.getElementById("dropdownMenuButton").addEventListener("click", function() {
                document.getElementById("dropdownMenu").classList.toggle("active");
            });

            document.getElementById("categoryMenu").closest('li').addEventListener('click', function(e){
                document.getElementById("categoryMenu").classList.toggle('active');
            })

            window.onclick = function(event) {
                if (!event.target.matches('.dropdown')) {
                    var dropdowns = document.getElementsByClassName("profile-menu");                    
                    if (dropdowns.classList.contains('active')) {
                        dropdowns.classList.remove('active');
                    }                    
                }
            }

        </script>
    </nav>

</body>

</html>